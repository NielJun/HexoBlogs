---
title: Kubernetes第一章 组件简介
date: 2020-02-05 10:17:34
tags: [Kubernetes,Micro Service,微服务]
categories: Go栈
---

## 云服务

- 基础设施及服务 [ Infrastructure as a Service ( IAAS ) ] 		国内以阿里云为代表
- 平台及服务 [ Platform as a Service  ( PAAS ) ]                      以新浪云为代表的的新浪平台套件 Sina SAE
- 软件设施及服务 [ SoftWare as a Service (SAAS) ]                以Micaosoft的基础软件构建，Office的B/S套件

以新浪的SAE服务来说，在申请一个PAAS服务来运行Java相关服务器程序的时候，在向sina云申请一个服务，sina后台接收到以后，会通过后台配置相对应地Java基础环境。但此时不是通过自动化的部署。

然后出现一些自动运维工具的出现，降低了环境配置的繁琐工作，但是这还不是真正的自动化，随着**Docker**的出现，这些像PAAS服务的自动化才正真实现，所以Docker自然成为PAAS的下一代标准。

虽然Docker解决了PAAS的容器化的相关问题，但是Docker容器内的相关联通交流映射问提就会显得非常复杂，比如：

在物理环境下，构建服务器集群使用标准的Tcp访问到对应的主机的数据库服务或者Ngix相关服务这是很简单的事。但我们有很多的物理机被Docker虚拟化为容器以后，物理机上的相应端口和Docker容器的端口通过防火墙进行数据包的传递，同时容器的集群化也是一个很大的问题。

## 资源管理器

![](/mesos.jpg)

### MESOS

为了解决容器化集群带来的复杂性问题，MESOS诞生，[Mesos](https://baike.baidu.com/item/Mesos)是Apache下的开源分布式资源管理框架，它被称为是分布式系统的内核。但是起初他不是为了解决容器化问题而诞生的，而是为了解决资源问题而产生的。但是Mesos只是一个管理平台，并没有很长久的使用。

![](/dockerswarm.png)

### DockerSwarm

Swarm 在 Docker 1.12 版本之前属于一个独立的项目，在 Docker 1.12 版本发布之后，该项目合并到了 Docker 中，成为 Docker 的一个子命令。目前，Swarm 是 Docker 社区提供的唯一一个原生支持 Docker 集群管理的工具。它可以把多个 Docker 主机组成的系统转换为单一的虚拟 Docker 主机，使得容器可以组成跨主机的子网网络。

Docker Swarm 是一个为 IT 运维团队提供集群和调度能力的编排工具。用户可以把集群中所有 Docker Engine 整合进一个「虚拟 Engine」的资源池，通过执行命令与单一的主 Swarm 进行沟通，而不必分别和每个 Docker Engine 沟通。在灵活的调度策略下，IT 团队可以更好地管理可用的主机资源，保证应用容器的高效运行。

实践中会发现，生产环境中使用单个 Docker 节点是远远不够的，搭建 Docker 集群势在必行。然而，面对 Kubernetes, Mesos 以及 Swarm 等众多容器集群系统，我们该如何选择呢？它们之中，Swarm 是 Docker 原生的，同时也是最简单，最易学，最节省资源的，比较适合中小型公司使用。

![](/kubernetes.png)

### Kubernetes

Kubernetes是Google开源的一款容器编排工具，它是诞生在Google内部运行N多年的博格系统之上的产物，因此其成熟度从其诞生初期就广泛受到业界的关注，并且迅速成为编排工具市场的主流，其社区活跃度非常高，版本迭代速度也很惊人，它的主要作用是对Docker容器做编排工作，当然，Docker只是容器工具的一种引擎，K8s可支持多种容器引擎，但从目前来说Docker容器引擎是具有绝对优势的。

容器需要编排，也很容易理解，因为我们最核心要跑到业务通常都是LNMT/P的不同形式的扩展，但NMT/P他们的运行是有先后顺序的，也就是说MySQL要先启动，然后是Tomcat或PHP，最后是Nginx，而控制这种顺序就需要有容器编排工具来帮我们实现，另外，我们的业务希望7x24小时在线，如何保障？靠人是很难做到实时的，但编排工具可以，K8s帮我们实现了很多控制器，这控制器可以帮我们监控容器运行的状态，并自动帮我们重建(在容器时代重启就是重建)容器，并且还可以在容器处理能力不足时，自动根据我们定义的扩展规则，自动创建新Pod(k8s中最小单元,每个Pod中可有一个或多个容器)，并且在压力下去后，自动删除Pod等等功能。

